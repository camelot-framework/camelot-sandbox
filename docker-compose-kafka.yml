dns:
  image: tonistiigi/dnsdock
  volumes:
    - /var/run/docker.sock:/run/docker.sock
  ports:
    - 172.17.42.1:53:53/udp
  command: /go/bin/dnsdock -domain dc

zookeeper:
  image: samsara/zookeeper
  expose:
    - "2181:2181"
    - "15001:15000"
  links:
    - dns:dns
  dns: 172.17.42.1
  environment:
    ZK_SERVER_ID: 1
    HOSTNAME: zookeeper.dc
    DNSDOCK_ALIAS: zookeeper.dc
  volumes:
    - target/logs/zk1:/logs
    - target/data/zk1:/data

kafka1:
  extends:
    file: common-services.yml
    service: kafka
  expose:
    - "15002:15000"
  links:
    - dns:dns
  environment:
    KAFKA_BROKER_ID: 1
    DNSDOCK_ALIAS: kafka1.dc
    HOSTNAME: kafka1.dc
    ADV_IP: kafka1.dc

kafka2:
  extends:
    file: common-services.yml
    service: kafka
  expose:
    - "15003:15000"
  links:
    - dns:dns
  environment:
    KAFKA_BROKER_ID: 2
    DNSDOCK_ALIAS: kafka2.dc
    HOSTNAME: kafka2.dc
    ADV_IP: kafka2.dc

kafka3:
  extends:
    file: common-services.yml
    service: kafka
  expose:
    - "15004:15000"
  links:
    - dns:dns
  environment:
    KAFKA_BROKER_ID: 3
    DNSDOCK_ALIAS: kafka3.dc
    HOSTNAME: kafka3.dc
    ADV_IP: kafka3.dc

kafkamanager:
  image: sheepkiller/kafka-manager
  ports:
    - "9000:9000"
  dns: 172.17.42.1
  links:
    - dns:dns
  environment:
    ZK_HOSTS: zookeeper.dc:2181
    DNSDOCK_ALIAS: kafkamanager.dc

camelot1:
  extends:
    file: common-services.yml
    service: camelot
  ports:
    - 18081:18082
  environment:
    DNSDOCK_ALIAS: camelot1.dc

camelot2:
  extends:
    file: common-services.yml
    service: camelot
  ports:
    - 18082:18082
  environment:
    DNSDOCK_ALIAS: camelot2.dc
